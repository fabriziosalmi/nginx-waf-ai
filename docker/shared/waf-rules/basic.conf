# Initial WAF rules - will be updated by AI system
# These rules are included in the http block

# Block common file extensions
map $uri $block_extension {
    ~*\.(env|git|svn|htaccess|htpasswd)$ 1;
    default 0;
}

# Map for SQL injection detection  
map $args $has_sql_injection {
    ~*union.*select 1;
    ~*drop.*table 1;
    ~*insert.*into 1;
    default 0;
}

# Map for XSS detection
map $args $has_xss {
    ~*<script 1;
    ~*javascript: 1;
    ~*vbscript: 1;
    ~*onload= 1;
    ~*onerror= 1;
    default 0;
}
